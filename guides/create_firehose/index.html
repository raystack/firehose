<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-guides/create_firehose">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v0.0.0-5124">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XXX"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-XXX",{})</script><title data-rh="true">Creating Firehose | Firehose</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://odpf.github.io//firehose/guides/create_firehose"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Creating Firehose | Firehose"><meta data-rh="true" name="description" content="This page contains how-to guides for creating Firehose with different sinks along with their features."><meta data-rh="true" property="og:description" content="This page contains how-to guides for creating Firehose with different sinks along with their features."><link data-rh="true" rel="icon" href="/firehose/assets/favicon.ico"><link data-rh="true" rel="canonical" href="https://odpf.github.io//firehose/guides/create_firehose"><link data-rh="true" rel="alternate" href="https://odpf.github.io//firehose/guides/create_firehose" hreflang="en"><link data-rh="true" rel="alternate" href="https://odpf.github.io//firehose/guides/create_firehose" hreflang="x-default"><link rel="stylesheet" href="/firehose/assets/css/styles.620b4533.css">
<link rel="preload" href="/firehose/assets/js/runtime~main.5046a373.js" as="script">
<link rel="preload" href="/firehose/assets/js/main.96db4ffd.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#222;color:#eee" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="announcementBarContent_xLdY">⭐️ If you like Firehose, give it a star on <a target="_blank" rel="noopener noreferrer" href="https://github.com/odpf/firehose">GitHub</a>! ⭐</div><button type="button" class="clean-btn close announcementBarClose_gvF7" aria-label="Close"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/firehose/"><div class="navbar__logo"><img src="/firehose/firehose.png" alt="Firehose" class="themedImage_ToTc themedImage--light_HNdA"><img src="/firehose/firehose.png" alt="Firehose" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Firehose</b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/firehose/">Documentation</a><a class="navbar__item navbar__link" href="/firehose/support">Support</a><a href="https://bit.ly/2RzPbtn" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-slack-link"></a><a href="https://github.com/odpf/firehose" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-item-github"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/firehose/"><img src="/firehose/firehose.png" alt="Firehose" class="themedImage_ToTc themedImage--light_HNdA"><img src="/firehose/firehose.png" alt="Firehose" class="themedImage_ToTc themedImage--dark_i4oU"><b>Firehose</b></a><nav class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/firehose/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/firehose/guides/create_firehose">Guides</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/firehose/guides/create_firehose">Creating Firehose</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/firehose/guides/json-based-filters">JSON-based Filters</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/firehose/guides/jexl-based-filters">JEXL-based Filters</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/firehose/guides/deployment">Deployment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/firehose/guides/manage">Troubleshooting</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/firehose/sinks/http-sink">Sinks</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/firehose/sinks/http-sink">HTTP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/firehose/sinks/grpc-sink">GRPC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/firehose/sinks/jdbc-sink">JDBC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/firehose/sinks/bigquery-sink">BigQuery</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/firehose/sinks/influxdb-sink">InfluxDB</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/firehose/sinks/prometheus-sink">Prometheus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/firehose/sinks/mongo-sink">MongoDB</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/firehose/sinks/redis-sink">Redis Sink</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/firehose/sinks/elasticsearch-sink">Elasticsearch</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/firehose/sinks/blob-sink">Blob</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/firehose/concepts/overview">Concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/firehose/advance/generic">Advance</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/firehose/reference/metrics">Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/firehose/contribute/contribution">Contribute</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/firehose/roadmap">Roadmap</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_GujU"><div class="docItemContainer_Adtb"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_aoJ5"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Creating Firehose</h1><p>This page contains how-to guides for creating Firehose with different sinks along with their features.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="create-a-log-sink">Create a Log Sink<a class="hash-link" href="#create-a-log-sink" title="Direct link to heading">​</a></h2><p>Firehose provides a log sink to make it easy to consume messages in <a href="https://en.wikipedia.org/wiki/Standard_streams#Standard_output_%28stdout%29" target="_blank" rel="noopener noreferrer">standard output</a>. A log sink firehose requires the following <a href="/firehose/advance/generic">variables</a> to be set. Firehose log sink can work in key as well as message parsing mode configured through <a href="/firehose/advance/generic#kafka_record_parser_mode"><code>KAFKA_RECORD_PARSER_MODE</code></a></p><p>An example log sink configurations:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">SOURCE_KAFKA_BROKERS=localhost:9092</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SOURCE_KAFKA_TOPIC=test-topic</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">KAFKA_RECOED_CONSUMER_GROUP_ID=sample-group-id</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">KAFKA_RECORD_PARSER_MODE=message</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SINK_TYPE=log</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">INPUT_SCHEMA_DATA_TYPE=protobuf</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">INPUT_SCHEMA_PROTO_CLASS=com.tests.TestMessage</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Sample output of a Firehose log sink:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">2021-03-29T08:43:05,998Z [pool-2-thread-1] INFO  i.o.firehose.Consumer- Execution successful for 1 records</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2021-03-29T08:43:06,246Z [pool-2-thread-1] INFO  i.o.firehose.Consumer - Pulled 1 messages</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2021-03-29T08:43:06,246Z [pool-2-thread-1] INFO  io.odpf.firehose.sink.log.LogSink -</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">================= DATA =======================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sample_field: 81179979</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sample_field_2: 9897987987</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">event_timestamp {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  seconds: 1617007385</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  nanos: 964581040</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="define-generic-configurations">Define generic configurations<a class="hash-link" href="#define-generic-configurations" title="Direct link to heading">​</a></h2><ul><li>These are the configurations that remain common across all the Sink Types.</li><li>You don’t need to modify them necessarily, It is recommended to use them with the default values. More details <a href="/firehose/advance/generic#standard">here</a>.</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="create-an-http-sink">Create an HTTP Sink<a class="hash-link" href="#create-an-http-sink" title="Direct link to heading">​</a></h2><p>Firehose <a href="https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol" target="_blank" rel="noopener noreferrer">HTTP</a> sink allows users to read data from Kafka and write to an HTTP endpoint. it requires the following <a href="/firehose/sinks/http-sink#http-sink">variables</a> to be set. You need to create your own HTTP endpoint so that the Firehose can send data to it.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="supported-methods">Supported methods<a class="hash-link" href="#supported-methods" title="Direct link to heading">​</a></h3><p>Firehose supports <code>PUT</code> and <code>POST</code> verbs in its HTTP sink. The method can be configured using <a href="/firehose/sinks/http-sink#sink_http_request_method"><code>SINK_HTTP_REQUEST_METHOD</code></a>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="authentication">Authentication<a class="hash-link" href="#authentication" title="Direct link to heading">​</a></h3><p>Firehose HTTP sink supports <a href="https://en.wikipedia.org/wiki/OAuth" target="_blank" rel="noopener noreferrer">OAuth</a> authentication. OAuth can be enabled for the HTTP sink by setting <a href="/firehose/sinks/http-sink#sink_http_oauth2_enable"><code>SINK_HTTP_OAUTH2_ENABLE</code></a></p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">SINK_HTTP_OAUTH2_ACCESS_TOKEN_URL: https://sample-oauth.my-api.com/oauth2/token  # OAuth2 Token Endpoint.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SINK_HTTP_OAUTH2_CLIENT_NAME: client-name  # OAuth2 identifier issued to the client.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SINK_HTTP_OAUTH2_CLIENT_SECRET: client-secret # OAuth2 secret issued for the client.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SINK_HTTP_OAUTH2_SCOPE: User:read, sys:info  # Space-delimited scope overrides.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="retries">Retries<a class="hash-link" href="#retries" title="Direct link to heading">​</a></h3><p>Firehose allows for retrying to sink messages in case of failure of HTTP service. The HTTP error code ranges to retry can be configured with <a href="/firehose/sinks/http-sink#sink_http_retry_status_code_ranges"><code>SINK_HTTP_RETRY_STATUS_CODE_RANGES</code></a>. HTTP request timeout can be configured with <a href="/firehose/sinks/http-sink#sink_http_request_timeout_ms"><code>SINK_HTTP_REQUEST_TIMEOUT_MS</code></a></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="templating">Templating<a class="hash-link" href="#templating" title="Direct link to heading">​</a></h3><p>Firehose HTTP sink supports payload templating using <a href="/firehose/sinks/http-sink#sink_http_json_body_template"><code>SINK_HTTP_JSON_BODY_TEMPLATE</code></a> configuration. It uses <a href="https://github.com/json-path/JsonPath" target="_blank" rel="noopener noreferrer">JsonPath</a> for creating Templates which is a DSL for basic JSON parsing. Playground for this: <a href="https://jsonpath.com/" target="_blank" rel="noopener noreferrer">https://jsonpath.com/</a>, where users can play around with a given JSON to extract out the elements as required and validate the <code>jsonpath</code>. The template works only when the output data format <a href="/firehose/sinks/http-sink#sink_http_data_format"><code>SINK_HTTP_DATA_FORMAT</code></a> is JSON.</p><p><em><strong>Creating Templates:</strong></em></p><p>This is really simple. Find the paths you need to extract using the JSON path. Create a valid JSON template with the static field names + the paths that need to extract. <!-- -->(<!-- -->Paths name starts with $.<!-- -->)<!-- -->. Firehose will simply replace the paths with the actual data in the path of the message accordingly. Paths can also be used on keys, but be careful that the element in the key must be a string data type.</p><p>One sample configuration<!-- -->(<!-- -->On XYZ proto<!-- -->)<!-- --> : <code>{&quot;test&quot;:&quot;$.routes[0]&quot;, &quot;$.order_number&quot; : &quot;xxx&quot;}</code> If you want to dump the entire JSON as it is in the backend, use <code>&quot;$._all_&quot;</code> as a path.</p><p>Limitations:</p><ul><li>Works when the input DATA TYPE is a protobuf, not a JSON.</li><li>Supports only on messages, not keys.</li><li>validation on the level of valid JSON template. But after data has been replaced the resulting string may or may not be a valid JSON. Users must do proper testing/validation from the service side.</li><li>If selecting fields from complex data types like repeated/messages/map of proto, the user must do filtering based first as selecting a field that does not exist would fail.</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="create-a-jdbc-sink">Create a JDBC sink<a class="hash-link" href="#create-a-jdbc-sink" title="Direct link to heading">​</a></h2><ul><li>Supports only PostgresDB as of now.</li><li>Data read from Kafka is written to the PostgresDB database and it requires the following <a href="/firehose/sinks/jdbc-sink#jdbc-sink">variables</a> to be set.</li></ul><p><em><strong>Note: Schema <!-- -->(<!-- -->Table, Columns, and Any Constraints<!-- -->)<!-- --> being used in firehose configuration must exist in the Database already.</strong></em></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="create-an-influxdb-sink">Create an InfluxDB sink<a class="hash-link" href="#create-an-influxdb-sink" title="Direct link to heading">​</a></h2><ul><li>Data read from Kafka is written to the InfluxDB time-series database and it requires the following <a href="/firehose/sinks/influxdb-sink#influx-sink">variables</a> to be set.</li></ul><p><em><strong>Note:</strong></em> <a href="/firehose/sinks/influxdb-sink#sink_influx_db_name"><em><strong>DATABASE</strong></em></a> <em><strong>and</strong></em> <a href="/firehose/sinks/influxdb-sink#sink_influx_retention_policy"><em><strong>RETENTION POLICY</strong></em></a> <em><strong>being used in firehose configuration must exist already in the Influx, It’s outside the scope of a firehose and won’t be generated automatically.</strong></em></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="create-a-redis-sink">Create a Redis sink<a class="hash-link" href="#create-a-redis-sink" title="Direct link to heading">​</a></h2><ul><li>it requires the following <a href="/firehose/sinks/redis-sink">variables</a> to be set.</li><li>Redis sink can be created in 2 different modes based on the value of <a href="/firehose/sinks/redis-sink#sink_redis_data_type"><code>SINK_REDIS_DATA_TYPE</code></a>: HashSet or List<ul><li><code>Hashset</code>: For each message, an entry of the format <code>key : field : value</code> is generated and pushed to Redis. field and value are generated on the basis of the config <a href="/firehose/sinks/redis-sink#-input_schema_proto_to_column_mapping-2"><code>INPUT_SCHEMA_PROTO_TO_COLUMN_MAPPING</code></a></li><li><code>List</code>: For each message entry of the format <code>key : value</code> is generated and pushed to Redis. Value is fetched for the proto index provided in the config <a href="/firehose/sinks/redis-sink#sink_redis_list_data_proto_index"><code>SINK_REDIS_LIST_DATA_PROTO_INDEX</code></a></li></ul></li><li>The <code>key</code> is picked up from a field in the message itself.</li><li>Redis sink also supports different <a href="/firehose/sinks/redis-sink#sink_redis_deployment_type">Deployment Types</a> <code>Standalone</code> and <code>Cluster</code>.</li><li>Limitation: Firehose Redis sink only supports HashSet and List entries as of now.</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="create-an-elasticsearch-sink">Create an Elasticsearch sink<a class="hash-link" href="#create-an-elasticsearch-sink" title="Direct link to heading">​</a></h2><ul><li>it requires the following <a href="/firehose/sinks/elasticsearch-sink">variables</a> to be set.</li><li>In the Elasticsearch sink, each message is converted into a document in the specified index with the Document type and ID as specified by the user.</li><li>Elasticsearch sink supports reading messages in both JSON and Protobuf formats.</li><li>Using <a href="/firehose/sinks/elasticsearch-sink#sink_es_routing_key_name">Routing Key</a> one can route documents to a particular shard in Elasticsearch.</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="create-a-grpc-sink">Create a GRPC sink<a class="hash-link" href="#create-a-grpc-sink" title="Direct link to heading">​</a></h2><ul><li>Data read from Kafka is written to a GRPC endpoint and it requires the following <a href="/firehose/sinks/grpc-sink">variables</a> to be set.</li><li>You need to create your own GRPC endpoint so that the Firehose can send data to it. The response proto should have a field “success” with value as true or false.</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="create-an-mongodb-sink">Create an MongoDB sink<a class="hash-link" href="#create-an-mongodb-sink" title="Direct link to heading">​</a></h2><ul><li>it requires the following <a href="/firehose/sinks/mongo-sink">variables</a> to be set.</li><li>In the MongoDB sink, each message is converted into a BSON Document and then inserted/updated/upserted into the specified Mongo Collection</li><li>MongoDB sink supports reading messages in both JSON and Protobuf formats.</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="create-a-blob-sink">Create a Blob sink<a class="hash-link" href="#create-a-blob-sink" title="Direct link to heading">​</a></h2><ul><li>it requires the following <a href="/firehose/sinks/blob-sink">variables</a> to be set.</li><li>Only support google cloud storage for now.</li><li>Only support writing protobuf message to apache parquet file format for now.</li><li>The protobuf message need to have a <code>google.protobuf.Timestamp</code> field as partitioning timestamp, <code>event_timestamp</code> field is usually being used.</li><li>Google cloud credential with some google cloud storage permission is required to run this sink.</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="create-a-bigquery-sink">Create a Bigquery sink<a class="hash-link" href="#create-a-bigquery-sink" title="Direct link to heading">​</a></h2><ul><li>it requires the following <a href="/firehose/sinks/bigquery-sink">variables</a> to be set.</li><li>For INPUT_SCHEMA_DATA_TYPE = protobuf, this sink will generate bigquery schema from protobuf message schema and update bigquery table with the latest generated schema.<ul><li>The protobuf message of a <code>google.protobuf.Timestamp</code> field might be needed when table partitioning is enabled.</li></ul></li><li>For INPUT_SCHEMA_DATA_TYPE = json, this sink will generate bigquery schema by infering incoming json. In future we will add support for json schema as well coming from stencil.<ul><li>The timestamp column is needed incase of partition table. It can be generated at the time of ingestion by setting the config. Please refer to config <code>SINK_BIGQUERY_ADD_EVENT_TIMESTAMP_ENABLE</code> in <a href="https://github.com/odpf/depot/blob/main/docs/reference/configuration/bigquery-sink.md#sink_bigquery_add_event_timestamp_enable" target="_blank" rel="noopener noreferrer">depot bigquery sink config section</a></li></ul></li><li>Google cloud credential with some bigquery permission is required to run this sink.</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="create-a-bigtable-sink">Create a Bigtable sink<a class="hash-link" href="#create-a-bigtable-sink" title="Direct link to heading">​</a></h2><ul><li>it requires the following environment  <a href="https://github.com/odpf/depot/blob/main/docs/reference/configuration/bigtable.md" target="_blank" rel="noopener noreferrer">variables</a> ,which are required by ODPF Depot library, to be set along with the generic firehose variables.</li></ul><p>If you&#x27;d like to connect to a sink which is not yet supported, you can create a new sink by following the <a href="/firehose/contribute/contribution">contribution guidelines</a></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/odpf/firehose/edit/master/docs/docs/guides/create_firehose.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_eYIM" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vbeJ"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/firehose/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Introduction</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/firehose/guides/json-based-filters"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">JSON-based Filters</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#create-a-log-sink" class="table-of-contents__link toc-highlight">Create a Log Sink</a></li><li><a href="#define-generic-configurations" class="table-of-contents__link toc-highlight">Define generic configurations</a></li><li><a href="#create-an-http-sink" class="table-of-contents__link toc-highlight">Create an HTTP Sink</a><ul><li><a href="#supported-methods" class="table-of-contents__link toc-highlight">Supported methods</a></li><li><a href="#authentication" class="table-of-contents__link toc-highlight">Authentication</a></li><li><a href="#retries" class="table-of-contents__link toc-highlight">Retries</a></li><li><a href="#templating" class="table-of-contents__link toc-highlight">Templating</a></li></ul></li><li><a href="#create-a-jdbc-sink" class="table-of-contents__link toc-highlight">Create a JDBC sink</a></li><li><a href="#create-an-influxdb-sink" class="table-of-contents__link toc-highlight">Create an InfluxDB sink</a></li><li><a href="#create-a-redis-sink" class="table-of-contents__link toc-highlight">Create a Redis sink</a></li><li><a href="#create-an-elasticsearch-sink" class="table-of-contents__link toc-highlight">Create an Elasticsearch sink</a></li><li><a href="#create-a-grpc-sink" class="table-of-contents__link toc-highlight">Create a GRPC sink</a></li><li><a href="#create-an-mongodb-sink" class="table-of-contents__link toc-highlight">Create an MongoDB sink</a></li><li><a href="#create-a-blob-sink" class="table-of-contents__link toc-highlight">Create a Blob sink</a></li><li><a href="#create-a-bigquery-sink" class="table-of-contents__link toc-highlight">Create a Bigquery sink</a></li><li><a href="#create-a-bigtable-sink" class="table-of-contents__link toc-highlight">Create a Bigtable sink</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Open DataOps Foundation © 2022</div></div></div></footer></div>
<script src="/firehose/assets/js/runtime~main.5046a373.js"></script>
<script src="/firehose/assets/js/main.96db4ffd.js"></script>
</body>
</html>